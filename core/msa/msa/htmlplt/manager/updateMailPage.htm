<HTML><HEAD><TITLE>网络7层管理和过滤的领导者</TITLE>
<META content="text/html; charset=utf-8" http-equiv=Content-Type>
<LINK rel=stylesheet type=text/css href="/ext/resources/css/ext-all.css">
<LINK rel=stylesheet type=text/css href="/ext/resources/css/xtheme-default.css">
<SCRIPT type=text/javascript src="/ext/adapter/ext/ext-base.js"></SCRIPT>
<SCRIPT type=text/javascript  src="/ext/ext-all.js"></SCRIPT>
<SCRIPT type=text/javascript  src="/msa/publicjs/pubstyle.js"></SCRIPT>
<link rel="stylesheet" type="text/css" href="/msa/publiccss/pubcss.css">
<link rel="stylesheet" href="/msa/publiccss/css.css" type="text/css">
<script type=text/javascript  src="/msa/publicjs/select_time_st_1.js"></script>
<script type=text/javascript  src="/msa/publicjs/exportexcel.js"></script>
<script type="text/javascript">
 function addlistfun() {
	var myid=listform.rid.value;
	var mynum=listform.num.value;
	var myrname=listform.rname.value;
	var mymailfrom=listform.mailfrom.value;
	var mymailto=listform.mailto.value;
	var mymailsub=listform.mailsub.value;
	var mymailcont=listform.mailcont.value;
	var mymailsize=listform.mailsize.value;
	var myattname=listform.attname.value;
	var myattsize=listform.attsize.value;
	var myflags=listform.flags.value;
	var mysflags=listform.sflags.value;
	var mysmail=listform.smail.value;
	var myrnum=listform.rnum.value;
	var mymaction=listform.maction.value;
	if(myrname=="")
	{
		alert("规则名称不能为空！");
		listform.rname.focus();
		listform.rname.select();
		return false;
	}
	if(mymailfrom=="")
	{
		alert("发件人不能为空！");
		listform.mailfrom.focus();
		listform.mailfrom.select();
		return false;
	}
	if(mymailto=="")
	{
		alert("收件人不能为空！");
		listform.mailto.focus();
		listform.mailto.select();
		return false;
	}
	if(mymailsub=="")
	{
		alert("邮件主题不能为空！");
		listform.mailsub.focus();
		listform.mailsub.select();
		return false;
	}
	if(mymailcont=="")
	{
		alert("邮件内容不能为空！");
		listform.mailcont.focus();
		listform.mailcont.select();
		return false;
	}
	if(mymailsize=="")
	{
		alert("邮件大小不能为空！");
		listform.mailsize.focus();
		listform.mailsize.select();
		return false;
	}
	if(myattname=="")
	{
		alert("附件名称不能为空！");
		listform.attname.focus();
		listform.attname.select();
		return false;
	}
	if(myattsize=="")
	{
		alert("附件大小不能为空！");
		listform.attsize.focus();
		listform.attsize.select();
		return false;
	}
	if(myrnum=="")
	{
		alert("收件人数目不能为空！");
		listform.rnum.focus();
		listform.rnum.select();
		return false;
	}
	if(!(mysflags=="0"))
	{
		if(mysmail=="")
		{
			alert("转发邮箱不能为空！");
			listform.smail.focus();
			listform.smail.select();
			return false;
		}
		if(mysmail!="")
		{
		  var regMail=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
		  var Email_flag=false;
		  if(regMail.test(mysmail)){
			Email_flag = true;
			}else{
			Email_flag = false;
			}
			if (!Email_flag){
			  alert("对不起，邮箱地址格式错误！");
				listform.smail.focus();
				listform.smail.select();
			  return false;
			}
		}
	}
	Ext.Ajax.request({
		method : 'POST', 
    url:'/msa/main.xp', 
    success: function() 
	  {
	     alert("修改邮件监控成功!");
    },
   failure : function() 
   {   
	  	alert("修改邮件监控失败!"); 
   },
   params:{Fun:'ltmailfilterlist',deflag:'2',rid:myid,num:mynum,rname:myrname,mailfrom:mymailfrom,mailto:mymailto,mailsub:mymailsub,mailcont:mymailcont,mailsize:mymailsize,attname:myattname,attsize:myattsize,flags:myflags,sflags:mysflags,smail:mysmail,rnum:myrnum,maction:mymaction}
  });
}
function fff(){ 
	if(document.all.a1.value==0){
	listform.smail.value="";
	document.all.b1.style.display="none";
	}else if(document.all.a1.value==1||document.all.a1.value==2){
	document.all.b1.style.display="";
	}
}
</SCRIPT>
<SCRIPT type=text/javascript>

Ext.BLANK_IMAGE_URL = '/msa/extjs/resources/images/default/s.gif';
Ext.onReady(function(){
	Ext.QuickTips.init();
	fff();
	new Ext.Panel({
		renderTo:Ext.getBody(),
		layout:'fit',
		height:screen.height-210,
		contentEl:'mainviewdiv'
		});
});
</SCRIPT>
</head>
<body bgcolor="#ffffff" text="#000000"  leftmargin="1" topmargin="0" >
	<div id="mainviewdiv" valign="top" align="center" STYLE="position:absolute; top=30; left=30; z-index:1;">
    <form name="listform">
	<table width="974" align="center">
	<tr>
		<td width="145">&nbsp;</td>
		<td width="196">&nbsp;</td>
	  <td width="106">&nbsp;</td>
	  <td width="502">&nbsp;</td>
	</tr>
		<tr>
      <td colspan="5">您可以修改邮件的各种属性</td>
    </tr>
		<tr>
			<input type="hidden"  name="rid" value="[$rid$]" class="inputf0">
		  <td width="145">执行序号</td>
		  <td width="196">
      	<select name="num" class=inputsel >
				 	<option value="0" [$num0sel$]> 0
				 	<option value="1" [$num1sel$]> 1
				 	<option value="2" [$num2sel$]> 2
				 	<option value="3" [$num3sel$]> 3
				 	<option value="4" [$num4sel$]> 4
				 	<option value="5" [$num5sel$]> 5
				 	<option value="6" [$num6sel$]> 6
				 	<option value="7" [$num7sel$]> 7
				 	<option value="8" [$num8sel$]> 8
				 	<option value="9" [$num9sel$]> 9
				 	<option value="10" [$num10sel$]> 10
				 	<option value="11" [$num11sel$]> 11
				 	<option value="12" [$num12sel$]> 12
				 	<option value="13" [$num13sel$]> 13
				 	<option value="14" [$num14sel$]> 14
				 	<option value="15" [$num15sel$]> 15
				 	<option value="16" [$num16sel$]> 16
				 	<option value="17" [$num17sel$]> 17
				 	<option value="18" [$num18sel$]> 18
				 	<option value="19" [$num19sel$]> 19
				 	<option value="20" [$num20sel$]> 20
				 	<option value="21" [$num21sel$]> 21
				 	<option value="22" [$num22sel$]> 22
				 	<option value="23" [$num23sel$]> 23
				 	<option value="24" [$num24sel$]> 24
				 	<option value="25" [$num25sel$]> 25
				 	<option value="26" [$num26sel$]> 26
				 	<option value="27" [$num27sel$]> 27
				 	<option value="28" [$num28sel$]> 28
				 	<option value="29" [$num29sel$]> 29
				 	<option value="30" [$num30sel$]> 30
				 	<option value="31" [$num31sel$]> 31
				 	<option value="32" [$num32sel$]> 32
	      </select>
		  <td>规则名称</td>
		  <td><input type="text"  name="rname" value="[$rname$]" class="inputf0" ></td>
		</tr>
		<tr>
		  <td>发件人</td>
		  <td width="196"><input type="text"  name="mailfrom" value="[$mailfrom$]" class="inputf0" ></td>
		  <td>收件人</td>
		  <td><input type="text"  name="mailto" value="[$mailto$]" class="inputf0"></td>
		</tr>
		<tr>
		  <td>主题</td>
		  <td width="196"><input type="text"  name="mailsub" value="[$mailsub$]" class="inputf0" ></td>
		  <td>内容</td>
		  <td><input type="text"  name="mailcont" value="[$mailcont$]" class="inputf0"></td>
		</tr>
     <tr><td>邮件大于</td>
     	<td width="196"><input type="text"  name="mailsize" value="[$mailsize$]" class="inputf0" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">字节</td>
	    <td>邮件类别</td>
	    <td> 
      	<select name="flags" class=inputsel >
				 	<option value="0" [$flags0sel$]> 发送邮件
				 	<option value="1" [$flags1sel$]> 接收邮件
	      </select>
      </td>
    </tr> 
		<tr>
		  <td>附件大于</td>
		  <td width="196"><input type="text"  name="attsize" value="[$attsize$]" class="inputf0" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">字节</td>
		  <td>附件名称</td>
		  <td><input type="text"  name="attname" value="[$attname$]" class="inputf0"></td>
		</tr>
		<tr>
      <td>监控否</td>
      <td width="196">
        <select name="maction" id="maction"  class=inputsel >
          <option value="0" [$maction0sel$]>不监控
          <option value="1" [$maction1sel$]>监控
        </select>
      </td>
	      <td>收件人多于</td>
        <td width="196"><input type="text" name="rnum" value="[$rnum$]"  class=inputf0 onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">个</td>
    </tr>
    <tr> 
      <td>通知</td>
      <td width="196"> 
      	<select name="sflags"  id="a1" class=inputsel onChange="fff()">
					<option value="0" [$sflags0sel$]> 不通知
				 	<option value="1" [$sflags1sel$]> 邮件通知
				 	<option value="2" [$sflags2sel$]> 转发
        </select>
      </td>
	      <td></td>
	      <td><input type="text" id="b1" name="smail" value="[$smail$]"  class=inputf0>
        </td>
    </tr>
		<hr/>
	<tr><td colspan="4"><hr/></td></tr>
		<tr><td>
			<input type="button" onClick="addlistfun();"  value="保存/修改"  class=inputf0 size=10>
			<input type="hidden" name="type" value="1" >
		</td>
		<td></td>
		</tr>
	</table>
</form>
</body>
</html>
